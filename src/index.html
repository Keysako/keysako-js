<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keysako Identity</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
        }
        .note {
            background: #f0f7ff;
            padding: 1rem;
            border-left: 4px solid #0066cc;
            margin: 1rem 0;
            border-radius: 0 4px 4px 0;
        }
    </style>
</head>
<body>
    <h1>Keysako Identity</h1>
    <p>A simple JavaScript library to integrate authentication with <a href="https://app.keysako.com">Keysako</a>, a solution that allows you to prove your identity while preserving your privacy.</p>

    <h2>Installation</h2>
    
    <h3>NPM</h3>
    <pre><code>npm install keysako-identity</code></pre>

    <h3>CDN</h3>
    <p>Choose one of the following options:</p>

    <h4>1. UMD (Universal Module Definition)</h4>
    <p>Basic usage:</p>
    <pre><code>&lt;script src="https://cdn.keysako.com/v{{ env.MAJOR_VERSION }}/keysako-connect.min.js"&gt;&lt;/script&gt;</code></pre>

    <p>Recommended secure usage:</p>
    <pre><code>&lt;script 
    src="https://cdn.keysako.com/v{{ env.MAJOR_VERSION }}/keysako-connect.min.js" 
    integrity="sha384-{{ env.CDN_HASH }}" 
    crossorigin="anonymous"&gt;&lt;/script&gt;</code></pre>

    <h4>2. ES Module</h4>
    <p>Basic usage:</p>
    <pre><code>&lt;script type="module" src="https://cdn.keysako.com/v{{ env.MAJOR_VERSION }}/keysako-connect.esm.js"&gt;&lt;/script&gt;</code></pre>

    <p>Recommended secure usage:</p>
    <pre><code>&lt;script 
    type="module" 
    src="https://cdn.keysako.com/v{{ env.MAJOR_VERSION }}/keysako-connect.esm.js" 
    integrity="sha384-{{ env.CDN_HASH }}" 
    crossorigin="anonymous"&gt;&lt;/script&gt;</code></pre>

    <div class="note">
        <h3>Security Best Practices</h3>
        <p>While the <code>integrity</code> and <code>crossorigin</code> attributes are optional, we strongly recommend using them for enhanced security:</p>
        <ul>
            <li><strong>integrity</strong>: Ensures the file hasn't been tampered with by verifying its hash</li>
            <li><strong>crossorigin="anonymous"</strong>: Ensures proper CORS handling when loading the script from our CDN</li>
        </ul>
        <p>You can find the current integrity hashes in:</p>
        <ul>
            <li>The <code>checksums.txt</code> file in this directory</li>
            <li>Our <a href="https://github.com/Keysako/keysako-js/releases">GitHub releases</a></li>
            <li>The npm package under <code>dist/v{{ env.MAJOR_VERSION }}/checksums.txt</code></li>
        </ul>
    </div>

    <h2>Available Files</h2>
    <ul>
        <li><a href="keysako-connect.min.js">keysako-connect.min.js</a> - Latest minified version (UMD)</li>
        <li><a href="keysako-connect.esm.js">keysako-connect.esm.js</a> - Latest ES Module version</li>
        <li><a href="keysako-connect-{{ env.VERSION }}.min.js">keysako-connect-{{ env.VERSION }}.min.js</a> - Current version minified (UMD)</li>
        <li><a href="keysako-connect-{{ env.VERSION }}.esm.js">keysako-connect-{{ env.VERSION }}.esm.js</a> - Current version ES Module</li>
        <li><a href="checksums.txt">checksums.txt</a> - File containing SHA-384 hashes for integrity verification</li>
    </ul>

    <h2>Configurateur</h2>
    <p>Utilisez notre <a href="configurator.html">configurateur en ligne</a> pour personnaliser facilement votre bouton Keysako Connect et obtenir le code correspondant.</p>

    <h2>Basic Example</h2>
    <p>Here's a complete example of how to use the Keysako Connect button:</p>
    
    <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Keysako Connect Example&lt;/title&gt;
    
    &lt;!-- Include Keysako Connect --&gt;
    &lt;script 
        src="https://cdn.keysako.com/v{{ env.MAJOR_VERSION }}/keysako-connect.min.js" 
        integrity="sha384-{{ env.CDN_HASH }}" 
        crossorigin="anonymous"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Login with Keysako&lt;/h1&gt;
    
    &lt;!-- Basic button --&gt;
    &lt;keysako-connect
        client-id="your-client-id"
        redirect-uri="https://your-app.com/callback"&gt;
    &lt;/keysako-connect&gt;
    
    &lt;!-- Button with age verification --&gt;
    &lt;keysako-connect
        client-id="your-client-id"
        redirect-uri="https://your-app.com/callback"
        age="18"
        theme="light"&gt;
    &lt;/keysako-connect&gt;
    
    &lt;!-- Button with callback --&gt;
    &lt;keysako-connect
        client-id="your-client-id"
        redirect-uri="https://your-app.com/callback"
        callback="handleAuth"&gt;
    &lt;/keysako-connect&gt;
    
    &lt;!-- Button with event listeners --&gt;
    &lt;keysako-connect
        id="keysako-button"
        client-id="your-client-id"
        redirect-uri="https://your-app.com/callback"
        theme="dark"
        shape="sharp"
        logo-only&gt;
    &lt;/keysako-connect&gt;
    
    &lt;script&gt;
        // Callback function example
        function handleAuth(response) {
            if (response.success) {
                console.log('Authentication successful:', response.data);
                if (response.hasRequiredAge) {
                    console.log('Age requirement met');
                }
            } else {
                console.error('Authentication failed:', response.error);
            }
        }

        // Event listeners example
        const button = document.getElementById('keysako-button');
        
        button.addEventListener('keysako:auth_complete', (event) => {
            const { success, token, hasRequiredAge, error } = event.detail;
            if (success) {
                console.log('Authentication successful:', token);
            } else {
                console.error('Authentication failed:', error);
            }
        });

        button.addEventListener('keysako:tokens_updated', (event) => {
            console.log('Token updated:', event.detail.token);
        });

        button.addEventListener('keysako:tokens_cleared', () => {
            console.log('Tokens cleared');
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

    <h2>Available Attributes</h2>
    <table>
        <thead>
            <tr>
                <th>Attribute</th>
                <th>Type</th>
                <th>Default</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>client-id</code></td>
                <td>string</td>
                <td>required</td>
                <td>Your Keysako client ID</td>
            </tr>
            <tr>
                <td><code>redirect-uri</code></td>
                <td>string</td>
                <td>required</td>
                <td>The URI where users will be redirected after authentication</td>
            </tr>
            <tr>
                <td><code>theme</code></td>
                <td>string</td>
                <td>'default'</td>
                <td>Button theme: 'default', 'light', or 'dark'</td>
            </tr>
            <tr>
                <td><code>age</code></td>
                <td>string</td>
                <td>-</td>
                <td>Display an age badge on the button (e.g., "18" for 18+)</td>
            </tr>
            <tr>
                <td><code>shape</code></td>
                <td>string</td>
                <td>'rounded'</td>
                <td>Button shape: 'rounded' or 'sharp'</td>
            </tr>
            <tr>
                <td><code>logo-only</code></td>
                <td>boolean</td>
                <td>false</td>
                <td>Display only the logo without text</td>
            </tr>
            <tr>
                <td><code>popup</code></td>
                <td>boolean</td>
                <td>false</td>
                <td>Use popup mode for authentication</td>
            </tr>
            <tr>
                <td><code>callback</code></td>
                <td>string</td>
                <td>-</td>
                <td>Name of the callback function to handle authentication results</td>
            </tr>
            <tr>
                <td><code>lang</code></td>
                <td>string</td>
                <td>-</td>
                <td>Force a specific language (overrides browser language)</td>
            </tr>
        </tbody>
    </table>

    <h2>Events</h2>
    <p>The button emits the following custom events:</p>
    <table>
        <thead>
            <tr>
                <th>Event Name</th>
                <th>Description</th>
                <th>Event Detail</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>keysako:auth_complete</code></td>
                <td>Fired when authentication is complete</td>
                <td><code>{ success: boolean, token?: string, hasRequiredAge?: boolean, error?: string }</code></td>
            </tr>
            <tr>
                <td><code>keysako:tokens_updated</code></td>
                <td>Fired when tokens are updated</td>
                <td><code>{ token: string }</code></td>
            </tr>
            <tr>
                <td><code>keysako:tokens_cleared</code></td>
                <td>Fired when tokens are cleared</td>
                <td>-</td>
            </tr>
        </tbody>
    </table>

    <p>For more examples and detailed documentation, visit our <a href="https://github.com/Keysako/keysako-js">GitHub repository</a>.</p>
</body>
</html>
